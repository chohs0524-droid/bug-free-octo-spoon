<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ì„±ì·¨ê¸°ì¤€ ë´‡</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css');

        body {
            font-family: 'Pretendard', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        }

        .chat-scroll::-webkit-scrollbar {
            width: 6px;
        }

        .chat-scroll::-webkit-scrollbar-thumb {
            background-color: #cbd5e1;
            border-radius: 4px;
        }

        .chat-scroll::-webkit-scrollbar-track {
            background-color: transparent;
        }

        .typing-dot {
            animation: typing 1.4s infinite ease-in-out both;
        }

        .typing-dot:nth-child(1) {
            animation-delay: -0.32s;
        }

        .typing-dot:nth-child(2) {
            animation-delay: -0.16s;
        }

        @keyframes typing {

            0%,
            80%,
            100% {
                transform: scale(0);
            }

            40% {
                transform: scale(1);
            }
        }

        .fade-in-up {
            animation: fadeInUp 0.5s ease-out forwards;
            opacity: 0;
            transform: translateY(20px);
        }

        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
    </style>
</head>

<body class="h-screen flex items-center justify-center p-4">

    <!-- Main Container -->
    <div
        class="w-full max-w-2xl bg-white rounded-3xl shadow-2xl overflow-hidden flex flex-col h-[80vh] border border-white/50 relative backdrop-blur-sm">

        <!-- Header -->
        <div class="bg-indigo-600 p-6 flex items-center justify-between text-white shrink-0 relative overflow-hidden">
            <div
                class="absolute top-0 right-0 w-32 h-32 bg-indigo-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob">
            </div>
            <div
                class="absolute -bottom-8 -left-8 w-32 h-32 bg-purple-500 rounded-full mix-blend-multiply filter blur-xl opacity-70 animate-blob animation-delay-2000">
            </div>

            <div class="z-10 flex items-center gap-4">
                <div
                    class="w-12 h-12 rounded-full bg-white/20 backdrop-blur flex items-center justify-center text-2xl border-2 border-white/30">
                    ğŸ¤–
                </div>
                <div>
                    <h1 class="text-xl font-bold">AI ì„±ì·¨ê¸°ì¤€ ë„ìš°ë¯¸</h1>
                    <p class="text-indigo-100 text-xs">í•™êµê¸‰ë³„, ê³¼ëª©ë³„ ì„±ì·¨ê¸°ì¤€ì„ ì°¾ì•„ë“œë¦½ë‹ˆë‹¤.</p>
                </div>
            </div>
            <button onclick="resetChat()"
                class="z-10 p-2 hover:bg-white/10 rounded-full transition-colors text-white/80 hover:text-white"
                title="ì²˜ìŒìœ¼ë¡œ">
                <i class="fas fa-redo-alt"></i>
            </button>
        </div>

        <!-- Chat Area -->
        <div id="chat-history" class="flex-1 overflow-y-auto p-6 space-y-6 chat-scroll bg-slate-50 relative">
            <!-- Messages will be injected here -->
        </div>

        <!-- Input Area (Optional, mostly for manual queries) -->
        <div class="p-4 bg-white border-t border-slate-100 shrink-0">
            <form id="chat-form" class="relative">
                <input type="text" id="chat-input"
                    class="w-full pl-5 pr-12 py-4 bg-slate-100 border-none rounded-2xl focus:ring-2 focus:ring-indigo-500 transition-all text-slate-700 placeholder-slate-400"
                    placeholder="ì§ì ‘ ì§ˆë¬¸í•˜ë ¤ë©´ ì—¬ê¸° ì…ë ¥ì„..." autocomplete="off">
                <button type="submit"
                    class="absolute right-2 top-2 p-2 bg-indigo-600 text-white rounded-xl hover:bg-indigo-700 transition-colors shadow-md w-10 h-10 flex items-center justify-center">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </form>
        </div>
    </div>

    <script>
        // Data
        const data = {
            subjects: [
                { id: 'ex:Korean', label: 'êµ­ì–´', grade: '4-6í•™ë…„', color: 'bg-blue-500' },
                { id: 'ex:Math', label: 'ìˆ˜í•™', grade: '4í•™ë…„', color: 'bg-green-500' },
                { id: 'ex:Science4', label: 'ê³¼í•™', grade: '4í•™ë…„', color: 'bg-yellow-500' },
                { id: 'ex:SocialStudies6', label: 'ì‚¬íšŒ', grade: '6í•™ë…„', color: 'bg-red-500' }
            ],
            standards: [
                // êµ­ì–´ (Assuming shared across grades for this dataset simplicity or specific grade logic can be added)
                // In the data provided, grades aren't explicitly split for Korean, but let's assume valid for 4-6.
                { id: 'ex:Standard_12hwa01_01', code: '[12í™”ì–¸01-01]', text: 'ì–¸ì–´ë¥¼ ì¸ê°„ì˜ ì‚¶ê³¼ ê´€ë ¨ì§€ì–´ ì´í•´í•˜ê³ , êµ­ì–´ì™€ êµ­ì–´ìƒí™œì´ ì‹œê°„ì˜ íë¦„ì— ë”°ë¼ ë³€í™”í•˜ëŠ” ì–‘ìƒì„ ë¶„ì„í•œë‹¤', subject: 'ex:Korean' },
                { id: 'ex:Standard_12hwa01_02', code: '[12í™”ì–¸01-02]', text: 'í‘œì¤€ ë°œìŒì„ ì´í•´í•˜ê³  ì •í™•í•˜ê²Œ ë°œìŒí•˜ëŠ” êµ­ì–´ìƒí™œì„ í•œë‹¤', subject: 'ex:Korean' },
                { id: 'ex:Standard_12hwa01_03', code: '[12í™”ì–¸01-03]', text: 'í’ˆì‚¬ì™€ ë¬¸ì¥ êµ¬ì¡°ì— ëŒ€í•œ ì§€ì‹ì„ í™œìš©í•˜ì—¬ ì–¸ì–´ ìë£Œë¥¼ ë¶„ì„í•˜ê³  ì„¤ëª…í•œë‹¤', subject: 'ex:Korean' },
                // ... (truncated for brevity, logic handles full search) 

                // ìˆ˜í•™ 
                { id: 'ex:Standard_4su02_01', code: '[4ìˆ˜02-01]', text: 'ë‹¤ì–‘í•œ ë³€í™” ê·œì¹™ì„ ì°¾ì•„ ì„¤ëª…í•˜ê³ , ê·¸ ê·œì¹™ì„ ìˆ˜ë‚˜ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
                { id: 'ex:Standard_4su02_02', code: '[4ìˆ˜02-02]', text: 'ê³„ì‚°ì‹ì˜ ë°°ì—´ì—ì„œ ê·œì¹™ì„ ì°¾ê³ , ê³„ì‚° ê²°ê³¼ë¥¼ ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
                { id: 'ex:Standard_4su01_05', code: '[4ìˆ˜01-05]', text: 'ë‚˜ëˆ—ì…ˆì´ ì´ë£¨ì–´ì§€ëŠ” ì‹¤ìƒí™œ ìƒí™©ê³¼ ì—°ê²°í•˜ì—¬ ë‚˜ëˆ—ì…ˆì˜ ì˜ë¯¸ë¥¼ ì•Œê³ , ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆì˜ ê´€ê³„ë¥¼ ì´í•´í•œë‹¤', subject: 'ex:Math' },

                // ê³¼í•™
                { id: 'ex:Standard_4gwa01_01', code: '[4ê³¼01-01]', text: 'ì¼ìƒìƒí™œì—ì„œ í˜ê³¼ ê´€ë ¨ëœ í˜„ìƒì— í¥ë¯¸ë¥¼ ê°–ê³ , ë¬¼ì²´ë¥¼ ë°€ê±°ë‚˜ ë‹¹ê¸¸ ë•Œ ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒì„ ê´€ì°°í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
                { id: 'ex:Standard_4gwa01_02', code: '[4ê³¼01-02]', text: 'ìˆ˜í‰ì¡ê¸° í™œë™ì„ í†µí•´ ë¬¼ì²´ì˜ ë¬´ê²Œë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },

                // ì‚¬íšŒ
                { id: 'ex:Standard_6sa04_01', code: '[6ì‚¬04-01]', text: 'ì„ ì‚¬ ì‹œëŒ€ì™€ ê³ ì¡°ì„ ì˜ ìœ ì ê³¼ ìœ ë¬¼ì„ í™œìš©í•˜ì—¬ ë‹¹ì‹œ ì‚¬ëŒë“¤ì˜ ìƒí™œì„ ì¶”ë¡ í•œë‹¤', subject: 'ex:SocialStudies6' },
                { id: 'ex:Standard_6sa04_02', code: '[6ì‚¬04-02]', text: 'ì—­ì‚¬ ê¸°ë¡ì´ë‚˜ ìœ ì ê³¼ ìœ ë¬¼ì— ë‚˜íƒ€ë‚œ ê³ ëŒ€ ì‚¬ëŒë“¤ì˜ ìƒê°ê³¼ ìƒí™œì„ ì¶”ë¡ í•œë‹¤', subject: 'ex:SocialStudies6' },
            ]
        };

        // Complete standard list from previous file content for full search capability
        const fullStandards = [
            { id: 'ex:Standard_12hwa01_01', code: '[12í™”ì–¸01-01]', text: 'ì–¸ì–´ë¥¼ ì¸ê°„ì˜ ì‚¶ê³¼ ê´€ë ¨ì§€ì–´ ì´í•´í•˜ê³ , êµ­ì–´ì™€ êµ­ì–´ìƒí™œì´ ì‹œê°„ì˜ íë¦„ì— ë”°ë¼ ë³€í™”í•˜ëŠ” ì–‘ìƒì„ ë¶„ì„í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_02', code: '[12í™”ì–¸01-02]', text: 'í‘œì¤€ ë°œìŒì„ ì´í•´í•˜ê³  ì •í™•í•˜ê²Œ ë°œìŒí•˜ëŠ” êµ­ì–´ìƒí™œì„ í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_03', code: '[12í™”ì–¸01-03]', text: 'í’ˆì‚¬ì™€ ë¬¸ì¥ êµ¬ì¡°ì— ëŒ€í•œ ì§€ì‹ì„ í™œìš©í•˜ì—¬ ì–¸ì–´ ìë£Œë¥¼ ë¶„ì„í•˜ê³  ì„¤ëª…í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_04', code: '[12í™”ì–¸01-04]', text: 'ë‹¨ì–´ì˜ ì§œì„ê³¼ ì˜ë¯¸, ë‹¨ì–´ ê°„ì˜ ì˜ë¯¸ ê´€ê³„ë¥¼ ì¤‘ì‹¬ìœ¼ë¡œ ì–´íœ˜ë¥¼ ì´í•´í•˜ê³  ë‹´í™”ì— ì ì ˆíˆ í™œìš©í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_05', code: '[12í™”ì–¸01-05]', text: 'ë‹´í™”ì˜ ë§¥ë½ì— ì ì ˆí•œ ì–´íœ˜ì™€ ë¬¸ë²• ìš”ì†Œë¥¼ ì„ íƒí•˜ì—¬ í™”ìì˜ íƒœë„ë¥¼ ë“œëŸ¬ë‚¸ë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_06', code: '[12í™”ì–¸01-06]', text: 'ë‹´í™”ì˜ êµ¬ì¡°ë¥¼ ê³ ë ¤í•˜ì—¬ ì ì ˆí•œ ì–´íœ˜ì™€ ë¬¸ì¥ìœ¼ë¡œ ì‘ì§‘ì„± ìˆëŠ” ë‹´í™”ë¥¼ êµ¬ì„±í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_07', code: '[12í™”ì–¸01-07]', text: 'ë‹¤ì–‘í•œ ìœ í˜•ì˜ ë‹´í™”ì™€ ë§¤ì²´ë¥¼ ëŒ€ìƒìœ¼ë¡œ ì–¸ì–´ì˜ ê³µê³µì„±ì„ ì´í•´í•˜ê³  í‰ê°€í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_08', code: '[12í™”ì–¸01-08]', text: 'ìì•„ ê°œë…ì´ ì˜ì‚¬ì†Œí†µ ë°©ì‹ì— ë¯¸ì¹˜ëŠ” ì˜í–¥ì„ ì¸ì‹í•˜ê³  í˜‘ë ¥ì ì¸ ê´€ê³„ í˜•ì„±ì— ì ì ˆí•œ ë°©ì‹ìœ¼ë¡œ ëŒ€í™”í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_09', code: '[12í™”ì–¸01-09]', text: 'ì •ì œëœ ì–¸ì–´ì  í‘œí˜„ ì „ëµ ë° ì ì ˆí•œ ì¤€ì–¸ì–´ì â‹…ë¹„ì–¸ì–´ì  í‘œí˜„ ì „ëµì„ í™œìš©í•˜ì—¬ ë°œí‘œí•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_12hwa01_10', code: '[12í™”ì–¸01-10]', text: 'í™”ìì˜ ê³µì‹ ë ¥ì„ ì´í•´í•˜ê³  íš¨ê³¼ì ì¸ ì„¤ë“ ì „ëµì„ í™œìš©í•˜ì—¬ ì—°ì„¤í•œë‹¤', subject: 'ex:Korean' },
            { id: 'ex:Standard_4su02_01', code: '[4ìˆ˜02-01]', text: 'ë‹¤ì–‘í•œ ë³€í™” ê·œì¹™ì„ ì°¾ì•„ ì„¤ëª…í•˜ê³ , ê·¸ ê·œì¹™ì„ ìˆ˜ë‚˜ ì‹ìœ¼ë¡œ ë‚˜íƒ€ë‚¼ ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su02_02', code: '[4ìˆ˜02-02]', text: 'ê³„ì‚°ì‹ì˜ ë°°ì—´ì—ì„œ ê·œì¹™ì„ ì°¾ê³ , ê³„ì‚° ê²°ê³¼ë¥¼ ì¶”ì¸¡í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_05', code: '[4ìˆ˜01-05]', text: 'ë‚˜ëˆ—ì…ˆì´ ì´ë£¨ì–´ì§€ëŠ” ì‹¤ìƒí™œ ìƒí™©ê³¼ ì—°ê²°í•˜ì—¬ ë‚˜ëˆ—ì…ˆì˜ ì˜ë¯¸ë¥¼ ì•Œê³ , ê³±ì…ˆê³¼ ë‚˜ëˆ—ì…ˆì˜ ê´€ê³„ë¥¼ ì´í•´í•œë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_06', code: '[4ìˆ˜01-06]', text: 'ë‚˜ëˆ„ëŠ” ìˆ˜ê°€ í•œ ìë¦¬ ìˆ˜ì¸ ë‚˜ëˆ—ì…ˆì˜ ê³„ì‚° ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  ê·¸ ê³„ì‚°ì„ í•  ìˆ˜ ìˆìœ¼ë©°, ë‚˜ëˆ—ì…ˆì—ì„œ ëª«ê³¼ ë‚˜ë¨¸ì§€ì˜ ì˜ë¯¸ë¥¼ ì•ˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_07', code: '[4ìˆ˜01-07]', text: 'ë‚˜ëˆ„ëŠ” ìˆ˜ê°€ ë‘ ìë¦¬ ìˆ˜ì¸ ë‚˜ëˆ—ì…ˆì˜ ê³„ì‚° ì›ë¦¬ë¥¼ ì´í•´í•˜ê³  ê·¸ ê³„ì‚°ì„ í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_01', code: '[4ìˆ˜01-01]', text: 'í° ìˆ˜ì˜ í•„ìš”ì„±ì„ ì¸ì‹í•˜ë©´ì„œ 10000 ì´ìƒì˜ í° ìˆ˜ì— ëŒ€í•œ ìë¦¿ê°’ê³¼ ìœ„ì¹˜ì  ê¸°ìˆ˜ë²•ì„ ì´í•´í•˜ê³ , ìˆ˜ë¥¼ ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_02', code: '[4ìˆ˜01-02]', text: 'ë‹¤ì„¯ ìë¦¬ ì´ìƒì˜ ìˆ˜ì˜ ë²”ìœ„ì—ì„œ ìˆ˜ì˜ ê³„ì—´ì„ ì´í•´í•˜ê³ , ìˆ˜ì˜ í¬ê¸°ë¥¼ ë¹„êµí•˜ë©° ê·¸ ë°©ë²•ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_09', code: '[4ìˆ˜01-09]', text: 'ì–‘ì˜ ë“±ë¶„í• ì„ í†µí•˜ì—¬ ë¶„ìˆ˜ì˜ í•„ìš”ì„±ì„ ì¸ì‹í•˜ê³ , ë¶„ìˆ˜ë¥¼ ì´í•´í•˜ê³  ì½ê³  ì“¸ ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_10', code: '[4ìˆ˜01-10]', text: 'ë‹¨ìœ„ë¶„ìˆ˜, ì§„ë¶„ìˆ˜, ê°€ë¶„ìˆ˜, ëŒ€ë¶„ìˆ˜ë¥¼ ì•Œê³ , ê·¸ ê´€ê³„ë¥¼ ì´í•´í•œë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4su01_11', code: '[4ìˆ˜01-11]', text: 'ë¶„ëª¨ê°€ ê°™ì€ ë¶„ìˆ˜ë¼ë¦¬, ë‹¨ìœ„ë¶„ìˆ˜ë¼ë¦¬ í¬ê¸°ë¥¼ ë¹„êµí•˜ê³  ê·¸ ë°©ë²•ì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Math' },
            { id: 'ex:Standard_4gwa01_01', code: '[4ê³¼01-01]', text: 'ì¼ìƒìƒí™œì—ì„œ í˜ê³¼ ê´€ë ¨ëœ í˜„ìƒì— í¥ë¯¸ë¥¼ ê°–ê³ , ë¬¼ì²´ë¥¼ ë°€ê±°ë‚˜ ë‹¹ê¸¸ ë•Œ ë‚˜íƒ€ë‚˜ëŠ” í˜„ìƒì„ ê´€ì°°í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa01_02', code: '[4ê³¼01-02]', text: 'ìˆ˜í‰ì¡ê¸° í™œë™ì„ í†µí•´ ë¬¼ì²´ì˜ ë¬´ê²Œë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa01_03', code: '[4ê³¼01-03]', text: 'ë¬´ê²Œë¥¼ ì •í™•íˆ ë¹„êµí•˜ê¸° ìœ„í•´ì„œëŠ” ì €ìš¸ì´ í•„ìš”í•¨ì„ ì•Œê³ , ì €ìš¸ì„ ì‚¬ìš©í•´ ë¬´ê²Œë¥¼ ë¹„êµí•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa01_04', code: '[4ê³¼01-04]', text: 'ì§€ë ˆ, ë¹—ë©´ê³¼ ê°™ì€ ë„êµ¬ë¥¼ ì´ìš©í•˜ë©´ ë¬¼ì²´ë¥¼ ë“¤ì–´ ì˜¬ë¦´ ë•Œ ë“œëŠ” í˜ì˜ í¬ê¸°ê°€ ë‹¬ë¼ì§ì„ ì•Œê³ , ë„êµ¬ê°€ ì¼ìƒìƒí™œì—ì„œ ì–´ë–»ê²Œ ì“°ì´ëŠ”ì§€ ì¡°ì‚¬í•˜ì—¬ ê³µìœ í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa02_01', code: '[4ê³¼02-01]', text: 'ì—¬ëŸ¬ ê°€ì§€ ë™ë¬¼ì„ ê´€ì°°í•˜ì—¬ íŠ¹ì§•ì— ë”°ë¼ ë™ë¬¼ì„ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa02_02', code: '[4ê³¼02-02]', text: 'ë‹¤ì–‘í•œ í™˜ê²½ì— ì„œì‹í•˜ëŠ” ë™ë¬¼ì„ ì¡°ì‚¬í•˜ì—¬ ë™ë¬¼ì˜ ìƒê¹€ìƒˆì™€ ìƒí™œ ë°©ì‹ì´ í™˜ê²½ê³¼ ê´€ë ¨ë˜ì–´ ìˆìŒì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa02_03', code: '[4ê³¼02-03]', text: 'ë™ë¬¼ì˜ íŠ¹ì§•ì„ ì´ìš©í•˜ì—¬ ì¼ìƒìƒí™œì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ìƒí™œìš©í’ˆì„ ì„¤ê³„í•˜ì—¬ í˜‘ë ¥ì ìœ¼ë¡œ ì†Œí†µí•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa03_01', code: '[4ê³¼03-01]', text: 'ì—¬ëŸ¬ ê°€ì§€ ì‹ë¬¼ì„ ê´€ì°°í•˜ì—¬ íŠ¹ì§•ì— ë”°ë¼ ì‹ë¬¼ì„ ë¶„ë¥˜í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa03_02', code: '[4ê³¼03-02]', text: 'ë‹¤ì–‘í•œ í™˜ê²½ì— ì„œì‹í•˜ëŠ” ì‹ë¬¼ì„ ì¡°ì‚¬í•˜ì—¬ ì‹ë¬¼ì˜ ìƒê¹€ìƒˆì™€ ìƒí™œ ë°©ì‹ì´ í™˜ê²½ê³¼ ê´€ë ¨ë˜ì–´ ìˆìŒì„ ì„¤ëª…í•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_4gwa03_03', code: '[4ê³¼03-03]', text: 'ì‹ë¬¼ì˜ íŠ¹ì§•ì„ ì´ìš©í•˜ì—¬ ì¼ìƒìƒí™œì—ì„œ í™œìš©í•  ìˆ˜ ìˆëŠ” ìƒí™œìš©í’ˆì„ ì„¤ê³„í•˜ì—¬ í˜‘ë ¥ì ìœ¼ë¡œ ì†Œí†µí•  ìˆ˜ ìˆë‹¤', subject: 'ex:Science4' },
            { id: 'ex:Standard_6sa04_01', code: '[6ì‚¬04-01]', text: 'ì„ ì‚¬ ì‹œëŒ€ì™€ ê³ ì¡°ì„ ì˜ ìœ ì ê³¼ ìœ ë¬¼ì„ í™œìš©í•˜ì—¬ ë‹¹ì‹œ ì‚¬ëŒë“¤ì˜ ìƒí™œì„ ì¶”ë¡ í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa04_02', code: '[6ì‚¬04-02]', text: 'ì—­ì‚¬ ê¸°ë¡ì´ë‚˜ ìœ ì ê³¼ ìœ ë¬¼ì— ë‚˜íƒ€ë‚œ ê³ ëŒ€ ì‚¬ëŒë“¤ì˜ ìƒê°ê³¼ ìƒí™œì„ ì¶”ë¡ í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa04_03', code: '[6ì‚¬04-03]', text: 'ë‹¤ì–‘í•œ ì—­ì‚¬ ìë£Œë¥¼ í™œìš©í•˜ì—¬ ê³ ë ¤ ì‹œëŒ€ ì‚¬íšŒ ëª¨ìŠµê³¼ ì‚¬ëŒë“¤ì˜ ìƒí™œì„ ì¶”ë¡ í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa05_01', code: '[6ì‚¬05-01]', text: 'ì¡°ì„  ì‹œëŒ€ ì‚¬ëŒë“¤ì˜ ìƒê°ê³¼ ìƒí™œì— ìœ êµ ë¬¸í™”ê°€ ë¯¸ì¹œ ì˜í–¥ì„ íŒŒì•…í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa05_02', code: '[6ì‚¬05-02]', text: 'ì¡°ì„  í›„ê¸° ì‚¬íšŒâ‹…ë¬¸í™”ì  ë³€í™”ì™€ ê°œí•­ê¸° ê·¼ëŒ€ ë¬¸ë¬¼ ìˆ˜ìš© ê³¼ì •ì—ì„œ ë‹¬ë¼ì§„ ì‚¬ëŒë“¤ì˜ ìƒí™œì„ ì´í•´í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa06_01', code: '[6ì‚¬06-01]', text: 'ì¼ì œì˜ ì‹ë¯¼ í†µì¹˜ì™€ ì´ì— ëŒ€í•œ ì €í•­ì´ ì‚¬íšŒì™€ ìƒí™œì— ë¯¸ì¹œ ì˜í–¥ì„ ì´í•´í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa06_02', code: '[6ì‚¬06-02]', text: '8â‹…15 ê´‘ë³µê³¼ 6â‹…25 ì „ìŸì´ ì‚¬íšŒì™€ ìƒí™œì— ë¯¸ì¹œ ì˜í–¥ì„ íŒŒì•…í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa07_01', code: '[6ì‚¬07-01]', text: 'ë¶„ë‹¨ìœ¼ë¡œ ë‚˜íƒ€ë‚œ ë¬¸ì œì ê³¼ ë¶„ë‹¨ê³¼ ê´€ë ¨ëœ ì¥ì†Œë¥¼ í‰í™”ì˜ ì¥ì†Œë¡œ ë§Œë“¤ë ¤ëŠ” ë…¸ë ¥ ë“±ì„ ì•Œì•„ë³´ê³ , í‰í™” í†µì¼ì„ ìœ„í•´ ìš°ë¦¬ê°€ í•  ìˆ˜ ìˆëŠ” ì¼ì„ íƒìƒ‰í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa07_02', code: '[6ì‚¬07-02]', text: 'ë¯¼ì£¼í™”ì™€ ì‚°ì—…í™”ë¡œ ì¸í•´ ë‹¬ë¼ì§„ ìƒí™œ ë¬¸í™”ë¥¼ ì‚¬ë¡€ë¥¼ ë“¤ì–´ ì´í•´í•œë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa08_01', code: '[6ì‚¬08-01]', text: 'ë¯¼ì£¼ì£¼ì˜ì—ì„œ ì„ ê±°ì˜ ì˜ë¯¸ì™€ ì—­í• ì„ íŒŒì•…í•˜ê³ , ì‹œë¯¼ì˜ ì£¼ê¶Œ í–‰ì‚¬ë¥¼ ìœ„í•´ ì„ ê±°ì— ì°¸ì—¬í•˜ëŠ” íƒœë„ë¥¼ ê¸°ë¥¸ë‹¤', subject: 'ex:SocialStudies6' },
            { id: 'ex:Standard_6sa08_02', code: '[6ì‚¬08-02]', text: 'ë¯¼ì£¼ êµ­ê°€ì—ì„œ êµ­íšŒ, í–‰ì •ë¶€, ë²•ì›ì´ í•˜ëŠ” ì¼ì— ëŒ€í•´ ì´í•´í•˜ê³ , ê° êµ­ê°€ê¸°ê´€ì˜ ê¶Œë ¥ì„ ë¶„ë¦½í•˜ëŠ” ì´ìœ ë¥¼ íƒìƒ‰í•œë‹¤', subject: 'ex:SocialStudies6' }
        ];

        // Chat Variables
        const chatHistory = document.getElementById('chat-history');
        const chatForm = document.getElementById('chat-form');
        const chatInput = document.getElementById('chat-input');

        let currentState = 'INIT'; // INIT, GRADE_SELECTED, SUBJ_SELECTED
        let selectedGrade = null;
        let selectedSubject = null;

        // UI Helpers
        function scrollToBottom() {
            chatHistory.scrollTop = chatHistory.scrollHeight;
        }

        function createMessageElement(isUser, htmlContent) {
            const wrapper = document.createElement('div');
            wrapper.className = `flex items-end gap-3 fade-in-up ${isUser ? 'flex-row-reverse' : ''} mb-4`;

            // Avatar for Bot
            if (!isUser) {
                const avatar = document.createElement('div');
                avatar.className = `w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shrink-0 shadow-md`;
                avatar.innerHTML = 'ğŸ¤–';
                wrapper.appendChild(avatar);
            }

            // Bubble
            const bubble = document.createElement('div');
            bubble.className = `max-w-[80%] py-3 px-5 rounded-2xl shadow-sm text-[15px] leading-relaxed relative ${isUser
                    ? 'bg-indigo-600 text-white rounded-br-none'
                    : 'bg-white text-slate-700 rounded-bl-none border border-slate-100'
                }`;
            bubble.innerHTML = htmlContent;

            wrapper.appendChild(bubble);
            return wrapper;
        }

        function showTypingIndicator() {
            const wrapper = document.createElement('div');
            wrapper.id = 'typing-indicator';
            wrapper.className = `flex items-end gap-3 fade-in-up mb-4`;

            const avatar = document.createElement('div');
            avatar.className = `w-10 h-10 rounded-full bg-gradient-to-br from-indigo-500 to-purple-600 flex items-center justify-center text-white shrink-0 shadow-md opacity-50`;
            avatar.innerHTML = 'ğŸ¤–';
            wrapper.appendChild(avatar);

            const bubble = document.createElement('div');
            bubble.className = `bg-white py-4 px-5 rounded-2xl rounded-bl-none shadow-sm border border-slate-100 flex gap-1`;

            for (let i = 0; i < 3; i++) {
                const dot = document.createElement('div');
                dot.className = `w-2 h-2 bg-slate-400 rounded-full typing-dot`;
                bubble.appendChild(dot);
            }

            wrapper.appendChild(bubble);
            chatHistory.appendChild(wrapper);
            scrollToBottom();
        }

        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        async function addMessage(htmlContent, isUser = false) {
            if (!isUser) {
                showTypingIndicator();
                await new Promise(r => setTimeout(r, 600)); // Simul network delay
                removeTypingIndicator();
            }
            const el = createMessageElement(isUser, htmlContent);
            chatHistory.appendChild(el);
            scrollToBottom();
        }

        // Logic
        function startChat() {
            currentState = 'INIT';
            addMessage(`
                ì•ˆë…•í•˜ì„¸ìš”! ì„ ìƒë‹˜, <strong>AI ì„±ì·¨ê¸°ì¤€ ë„ìš°ë¯¸</strong>ì…ë‹ˆë‹¤. ğŸ‘‹<br>
                ì–´ë–¤ í•™ë…„ì˜ ì„±ì·¨ê¸°ì¤€ì„ ì°¾ê³  ê³„ì‹ ê°€ìš”?<br>
                <div class="flex gap-2 mt-3 flex-wrap">
                    <button onclick="selectGrade('4í•™ë…„')" class="px-4 py-2 bg-indigo-50 text-indigo-700 rounded-xl hover:bg-indigo-100 border border-indigo-200 transition-colors font-medium">4í•™ë…„</button>
                    <button onclick="selectGrade('6í•™ë…„')" class="px-4 py-2 bg-indigo-50 text-indigo-700 rounded-xl hover:bg-indigo-100 border border-indigo-200 transition-colors font-medium">6í•™ë…„</button>
                </div>
            `);
        }

        window.selectGrade = function (grade) {
            selectedGrade = grade;
            addMessage(grade, true); // User msg

            // Filter subjects by grade
            // Note: Data provided has specific grades. 
            // "Korean" is 4-6, so it appears in both.
            // "Math" is 4, "Science" is 4. "Social" is 6.

            const availableSubjects = data.subjects.filter(s => s.grade.includes(grade) || s.grade === '4-6í•™ë…„');

            let buttonsHtml = availableSubjects.map(s =>
                `<button onclick="selectSubject('${s.id}', '${s.label}')" class="px-4 py-2 ${s.color.replace('bg-', 'bg-opacity-10 text-').replace('500', '700')} hover:bg-opacity-20 rounded-xl transition-colors font-medium border border-transparent hover:border-current">${s.label}</button>`
            ).join('');

            setTimeout(() => {
                addMessage(`
                    <strong>${grade}</strong>ì„ ì„ íƒí•˜ì…¨êµ°ìš”.<br>
                    ì–´ë–¤ ê³¼ëª©ì˜ ì„±ì·¨ê¸°ì¤€ì„ ë³´ì—¬ë“œë¦´ê¹Œìš”?
                    <div class="flex gap-2 mt-3 flex-wrap">
                        ${buttonsHtml}
                    </div>
                `);
            }, 300);
        }

        window.selectSubject = function (subId, subLabel) {
            selectedSubject = { id: subId, label: subLabel };
            addMessage(subLabel, true);

            const standards = fullStandards.filter(s => s.subject === subId);

            setTimeout(() => {
                let standardList = standards.map(s => `
                    <div class="bg-slate-50 p-3 rounded-lg border border-slate-200 text-sm hover:border-indigo-300 transition-colors">
                        <span class="font-bold text-indigo-600 block mb-1">${s.code}</span>
                        ${s.text}
                    </div>
                `).join('');

                if (standards.length === 0) {
                    standardList = `<div class="text-slate-500 italic">ë“±ë¡ëœ ì„±ì·¨ê¸°ì¤€ì´ ì—†ìŠµë‹ˆë‹¤.</div>`;
                }

                addMessage(`
                    <strong>${selectedGrade} ${subLabel}</strong> ì„±ì·¨ê¸°ì¤€ ${standards.length}ê°œë¥¼ ì°¾ì•˜ìŠµë‹ˆë‹¤.
                    <div class="space-y-2 mt-3 max-h-[300px] overflow-y-auto pr-2 custom-scroll">
                        ${standardList}
                    </div>
                    <div class="mt-4 text-xs text-slate-400">
                        ë‹¤ë¥¸ ê³¼ëª©ì„ ë³´ì‹œë ¤ë©´ ìœ„ ë²„íŠ¼ì„ ë‹¤ì‹œ ëˆ„ë¥´ê±°ë‚˜, "ì²˜ìŒìœ¼ë¡œ"ë¥¼ ëˆŒëŸ¬ì£¼ì„¸ìš”.
                    </div>
                `);
            }, 300);
        }

        window.resetChat = function () {
            chatHistory.innerHTML = '';
            startChat();
        }

        // Manual Input Handler
        chatForm.addEventListener('submit', (e) => {
            e.preventDefault();
            const msg = chatInput.value.trim();
            if (!msg) return;

            addMessage(msg, true);
            chatInput.value = '';

            // Simple search logic for manual input
            setTimeout(() => {
                // Check if it matches a grade
                if (msg.includes('4í•™ë…„')) { selectGrade('4í•™ë…„'); return; }
                if (msg.includes('6í•™ë…„')) { selectGrade('6í•™ë…„'); return; }

                // Check standard codes or keywords
                const results = fullStandards.filter(s =>
                    s.text.includes(msg) ||
                    s.code.includes(msg) ||
                    (s.code.replace(/[\[\]]/g, '') === msg)
                );

                if (results.length > 0) {
                    let listHtml = results.slice(0, 5).map(s => `
                        <div class="bg-slate-50 p-3 rounded-lg border border-slate-200 text-sm">
                            <span class="font-bold text-indigo-600">${s.code}</span> ${s.text}
                        </div>
                    `).join('');

                    if (results.length > 5) {
                        listHtml += `<div class="text-center text-xs text-slate-500 py-1">...ì™¸ ${results.length - 5}ê±´</div>`;
                    }

                    addMessage(`
                        "${msg}" ê²€ìƒ‰ ê²°ê³¼ ${results.length}ê±´ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.
                        <div class="space-y-2 mt-3">
                            ${listHtml}
                        </div>
                    `);
                } else {
                    addMessage(`
                        ì£„ì†¡í•©ë‹ˆë‹¤. "${msg}"ì— ëŒ€í•œ ê²°ê³¼ë¥¼ ì°¾ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.<br>
                        "êµ­ì–´", "ìˆ˜í•™" ê°™ì€ ê³¼ëª©ëª…ì´ë‚˜ "4í•™ë…„" ë“±ì„ ì„ íƒí•´ë³´ì„¸ìš”.
                    `);
                }
            }, 500);
        });

        // Initialize
        startChat();

    </script>
</body>

</html>